title,challenge_text,display_text,invocation_timestamp,iteration_num,gold_query_text,generated_sql_query_text,generated_semantic_query_text,gold_query_df,generated_sql_df,generated_semantic_df,is_sql_result_equivalent,is_semantic_result_equivalent,sql_comparison_exception,semantic_comparison_exception
HQLS: Claim,How many claims do we have?,"How many
claims do we have?",1700624974.5562727,0,"SELECT COUNT(*) AS NoOfClaims
FROM claim",SELECT COUNT(*) FROM Claim,"select * from {{
    semantic_layer.query(metrics=['claims'])
}}","   NOOFCLAIMS
0           2","   COUNT(*)
0         2","   CLAIMS
0       2",true,true,,
HQLS: Claim - Loss Payment&Loss Reserve,"What is the total loss amounts, which is the sum of loss payment, loss reserve amount by claim number?","What is the total loss amounts, which is the sum
of loss payment, loss reserve amount by claim number?",1700624992.746069,0,"SELECT
    company_claim_number,
    (ca_lp.claim_amount + ca_lr.claim_amount ) as LossAmount
FROM
    Claim
    inner join claim_amount ca_lp on claim.claim_identifier = ca_lp.claim_identifier
    inner JOIN loss_payment ON ca_lp.claim_amount_identifier = loss_payment.claim_amount_identifier
    inner join claim_amount ca_lr on claim.claim_identifier = ca_lr.claim_identifier
    inner JOIN loss_reserve ON ca_lr.claim_amount_identifier = loss_reserve.claim_amount_identifier
","SELECT 
    Claim.Claim_Identifier,
    SUM(Loss_Payment.Claim_Amount + Loss_Reserve.Claim_Amount) AS Total_Loss_Amounts
FROM 
    Claim 
LEFT JOIN 
    Claim_Amount AS Loss_Payment ON Claim.Claim_Identifier = Loss_Payment.Claim_Identifier 
LEFT JOIN 
    Claim_Amount AS Loss_Reserve ON Claim.Claim_Identifier = Loss_Reserve.Claim_Identifier 
GROUP BY 
    Claim.Claim_Identifier;","select * from {{
    semantic_layer.query(metrics=['loss_payment_amount', 'loss_reserve_amount', 'total_loss_amount'], 
    group_by=['claim_identifier__company_claim_number'])
    }}","   COMPANY_CLAIM_NUMBER  LOSSAMOUNT
0              12312701        2200
1              12312702        4400","   CLAIM_IDENTIFIER  TOTAL_LOSS_AMOUNTS
0                 1               36800
1                 2               72000","   CLAIM_IDENTIFIER__COMPANY_CLAIM_NUMBER  LOSS_PAYMENT_AMOUNT  LOSS_RESERVE_AMOUNT  TOTAL_LOSS_AMOUNT
0                                12312701                 1200                 1000               2200
1                                12312702                 2300                 2100               4400",false,true,"""None of [Index(['COMPANY_CLAIM_NUMBER', 'LOSSAMOUNT'], dtype='object')] are in the [columns]""",
HQLS: What is the average time to settle a claim by policy number?,What is the average time to settle a claim by policy number?,"What is the average time to
settle a claim by policy number?",1700625020.9127207,0,"select policy_number, avg(DATE_DIFF(claim_open_date, claim_close_date, ""day""))
from claim 
inner join claim_coverage on claim.claim_identifier = claim_coverage.claim_identifier
inner join policy_coverage_detail on claim_coverage.policy_coverage_detail_identifier = policy_coverage_detail.policy_coverage_detail_identifier
inner join policy on policy.policy_identifier = policy_coverage_detail.policy_identifier
where claim_close_date IS NOT NULL
group by policy_number
","SELECT Policy.Policy_Number, AVG(DATEDIFF(day, Claim.Claim_Open_Date, Claim.Claim_Close_Date)) as Average_Settlement_Time
FROM Claim
INNER JOIN Claim_Coverage ON Claim.Claim_Identifier = Claim_Coverage.Claim_Identifier
INNER JOIN Policy_Coverage_Detail ON Claim_Coverage.Policy_Coverage_Detail_Identifier = Policy_Coverage_Detail.Policy_Coverage_Detail_Identifier
INNER JOIN Policy ON Policy_Coverage_Detail.Policy_Identifier = Policy.Policy_Identifier
WHERE Claim.Claim_Close_Date IS NOT NULL
GROUP BY Policy.Policy_Number","select * from {{
    semantic_layer.query(metrics=['avg_time_to_settle_claim'], 
    group_by=['policy__policy_number'])
}}","   POLICY_NUMBER  AVG(DATEDIFF(DAY, CLAIM_OPEN_DATE, CLAIM_CLOSE_DATE))
0    31003000336                                               20.5    ","   POLICY_NUMBER AVERAGE_SETTLEMENT_TIME
0    31003000336               20.500000","                                                                                                                                                                                                                                                                                                                                                                                                                 error
0  INVALID_ARGUMENT: [FlightSQL] Unable To Satisfy Query Error: Dimensions ['policy__policy_number'] cannot be resolved for metrics ['avg_time_to_settle_claim']. The invalid dimension may not exist, require an ambiguous join (e.g. a join path that can be satisfied in multiple ways), or require a fanout join.\n\nSuggestions for invalid dimension 'policy__policy_number':\n    [] (InvalidArgument; Prepare)",true,false,,
HQLS: Policy - Coverage - Premium,What is the average policy size which is the the total amount of premium divided by the number of policies?,"What is the average policy size which is the the
total amount of premium divided by the number of policies?",1700625047.3495574,0,"SELECT
    SUM(policy_amount)/COUNT(DISTINCT policy_number) AS avgPolicySize
FROM
   policy_coverage_detail 
    inner join policy on policy.policy_identifier = policy_coverage_detail.policy_identifier
    inner join policy_amount on policy_coverage_detail.policy_coverage_detail_identifier = policy_amount.policy_coverage_detail_identifier
    inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
","SELECT AVG(Total_Premium / Number_of_Policies) as Average_Policy_Size
FROM
(
    SELECT SUM(Policy_Amount) as Total_Premium, COUNT(DISTINCT Policy_Identifier) as Number_of_Policies
    FROM Policy_Amount
    INNER JOIN Premium
    ON Policy_Amount.Policy_Amount_Identifier = Premium.Policy_Amount_Identifier
) as SubQuery","select avg(total_policy_amount/number_of_policies) as avg_policy_size from {{
    semantic_layer.query(metrics=['total_policy_amount', 'number_of_policies'])
}}","  AVGPOLICYSIZE
0  49000.000000","  AVERAGE_POLICY_SIZE
0  49000.000000000000","        AVG_POLICY_SIZE
0  2849000.000000000000",true,false,,"""None of [Index(['AVGPOLICYSIZE'], dtype='object')] are in the [columns]"""
HQLS: Policy - Agent,How many policies have agents sold by agent id?,"How many policies have
agents sold by agent id?",1700625071.3117046,0,"select  party_identifier as agentid, count(policy.policy_number) as NoOfPolicies
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
where agreement_party_role.party_role_code = 'AG'
group by party_identifier","SELECT Party_Identifier AS Agent_ID, COUNT(DISTINCT Policy_Identifier) AS Policies_Sold
FROM Agreement_Party_Role 
WHERE Party_Role_Code = 'Agent'
GROUP BY Party_Identifier;","select * from {{
    semantic_layer.query(metrics=['number_of_policies'], 
    group_by=['policy__party_identifier_dim'],
    where=""{{ Dimension('policy__party_role_code') }} = 'AG'""
    )}}","   AGENTID  NOOFPOLICIES
0        2             2","                                                                                                                                                 error
0  INVALID_ARGUMENT: [FlightSQL] SQL compilation error: error line 1 at position 52\ninvalid identifier 'POLICY_IDENTIFIER' (InvalidArgument; Prepare)","   POLICY__PARTY_IDENTIFIER_DIM  NUMBER_OF_POLICIES
0                             2                   2",false,true,,
HQLS: What is the total amount of premiums that a policy holder has paid?,What is the total amount of premiums that a policy holder has paid?,"What is the total amount of
premiums that a policy holder has paid?",1700625092.9499745,0,"select party_identifier, sum(policy_amount)
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
inner join policy_amount on policy.policy_identifier = policy_amount.policy_identifier
inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
where agreement_party_role.party_role_code = 'PH'
group by party_identifier","SELECT SUM(Policy_Amount) AS Total_Premiums_Paid
FROM Premium
JOIN Policy_Amount
ON Premium.Policy_Amount_Identifier = Policy_Amount.Policy_Amount_Identifier;","select * from {{
    semantic_layer.query(metrics=['total_policy_amount'], 
    group_by=['policy__party_identifier_dim'],
    where=""{{ Dimension('policy_amount__has_premium') }} = 1 AND {{ Dimension('policy__party_role_code') }} = 'PH'""
    )}}","   PARTY_IDENTIFIER  SUM(POLICY_AMOUNT)
0                 1               98000","   TOTAL_PREMIUMS_PAID
0                98000","   POLICY__PARTY_IDENTIFIER_DIM  TOTAL_POLICY_AMOUNT
0                             1                98000",false,true,"""['PARTY_IDENTIFIER'] not in index""",
HQLS: What is the total amount of premiums that a policy holder has paid by policy number?,What is the total amount of premiums that a policy holder has paid by policy number?,"What is the total amount of premiums that
a policy holder has paid by policy number?",1700625118.646458,0,"select party_identifier, policy_number, sum(policy_amount)
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
inner join policy_amount on policy.policy_identifier = policy_amount.policy_identifier
inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
where agreement_party_role.party_role_code = 'PH'
group by party_identifier, policy_number","SELECT Policy.Policy_Number, SUM(Premium.Policy_Amount) AS Total_Premiums_Paid
FROM Policy
JOIN Policy_Amount ON Policy.Policy_Identifier = Policy_Amount.Policy_Identifier
JOIN Premium ON Policy_Amount.Policy_Amount_Identifier = Premium.Policy_Amount_Identifier
GROUP BY Policy.Policy_Number;","select * from {{
    semantic_layer.query(metrics=['total_policy_amount'], 
    group_by=['policy__policy_number', 'policy__party_identifier_dim'],
    where=""{{ Dimension('policy_amount__has_premium') }} = 1 AND {{ Dimension('policy__party_role_code') }} = 'PH'""
    )}}","   PARTY_IDENTIFIER  POLICY_NUMBER  SUM(POLICY_AMOUNT)
0                 1    31003000336               86000
1                 1    31003000337               12000","                                                                                                                                                     error
0  INVALID_ARGUMENT: [FlightSQL] SQL compilation error: error line 1 at position 33\ninvalid identifier 'PREMIUM.POLICY_AMOUNT' (InvalidArgument; Prepare)","   POLICY__PARTY_IDENTIFIER_DIM  POLICY__POLICY_NUMBER  TOTAL_POLICY_AMOUNT
0                             1            31003000336                86000
1                             1            31003000337                12000",false,true,,
HQLS: Policy - Policy Holder,How many policies does each policy holder have by policy holder id?,"How many policies does each
policy holder have by policy holder id?",1700625143.304068,0,"select party_identifier, count( policy.policy_number)  as NoOfPolicies
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
where agreement_party_role.party_role_code = 'PH'
group by party_identifier","SELECT Agreement_Party_Role.Party_Identifier as Policy_Holder_ID, COUNT(DISTINCT Policy.Policy_Identifier) as Number_of_Policies
FROM Agreement_Party_Role
JOIN Policy ON Agreement_Party_Role.Agreement_Identifier = Policy.Policy_Identifier
GROUP BY Agreement_Party_Role.Party_Identifier;","select * from {{
    semantic_layer.query(metrics=['number_of_policies'], 
    group_by=['policy__party_identifier_dim'],
    where=""{{ Dimension('policy__party_role_code') }} = 'PH'""
    )}}","   PARTY_IDENTIFIER  NOOFPOLICIES
0                 1             2","   POLICY_HOLDER_ID  NUMBER_OF_POLICIES
0                 1                   2
1                 2                   2","   POLICY__PARTY_IDENTIFIER_DIM  NUMBER_OF_POLICIES
0                             1                   2",false,true,"""None of [Index(['NOOFPOLICIES', 'PARTY_IDENTIFIER'], dtype='object')] are in the [columns]""",
HQLS: Policy - Coverage - Claim,How many claims have been placed by policy number?,"How many claims have
been placed by policy number?",1700625169.5220354,0,"select policy_number, count(company_claim_number) as NoOfClaims
from 
    policy 
    inner join policy_coverage_detail on policy.policy_identifier = policy_coverage_detail.policy_identifier
    inner join claim_coverage on claim_coverage.policy_coverage_detail_identifier = policy_coverage_detail.policy_coverage_detail_identifier
    inner join claim on claim.claim_identifier = claim_coverage.claim_identifier
group by policy_number","SELECT Policy_Number, COUNT(*) AS Number_of_Claims
FROM Claim 
JOIN Policy ON Claim.Claim_Identifier = Policy.Policy_Identifier
GROUP BY Policy_Number;","select * from {{
    semantic_layer.query(metrics=['claims'], 
    group_by=['claim_identifier__policy_number'])
}}","   POLICY_NUMBER  NOOFCLAIMS
0    31003000336           2","   POLICY_NUMBER  NUMBER_OF_CLAIMS
0    31003000336                 1
1    31003000337                 1","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          error
0  INVALID_ARGUMENT: [FlightSQL] Unable To Satisfy Query Error: Dimensions ['claim_identifier__policy_number'] cannot be resolved for metrics ['claims']. The invalid dimension may not exist, require an ambiguous join (e.g. a join path that can be satisfied in multiple ways), or require a fanout join.\n\nSuggestions for invalid dimension 'claim_identifier__policy_number':\n    ['claim_identifier__company_claim_number',\n     'claim_identifier__company_subclaim_number',\n     'claim_identifier__policy_coverage_detail',\n     'claim_identifier__claim_identifier',\n     'claim_identifier__claim_description',\n     'claim_identifier__claim_open_date__year'] (InvalidArgument; Prepare)",false,false,"""['NOOFCLAIMS'] not in index""",
HQLS: What is the total amount of premiums paid by policy number?,What is the total amount of premiums paid by policy number?,"What is the total amount of
premiums paid by policy number?",1700625188.9528587,0,"select policy_number, sum(policy_amount) as TotalPremiumAmount
from 
    policy 
    inner join policy_amount on policy.policy_identifier = policy_amount.policy_identifier
    inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
group by policy_number","SELECT Policy.Policy_Number, SUM(Premium.Policy_Amount) as Total_Premiums
FROM Premium
INNER JOIN Policy_Amount ON Premium.Policy_Amount_Identifier = Policy_Amount.Policy_Amount_Identifier
INNER JOIN Policy ON Policy_Amount.Policy_Identifier = Policy.Policy_Identifier
GROUP BY Policy.Policy_Number;","select * from {{
    semantic_layer.query(metrics=['total_policy_amount'], 
    group_by=['policy__policy_number'],
    where=""{{ Dimension('policy_amount__has_premium') }} = 1""
    )}}","   POLICY_NUMBER  TOTALPREMIUMAMOUNT
0    31003000336               86000
1    31003000337               12000","                                                                                                                                                     error
0  INVALID_ARGUMENT: [FlightSQL] SQL compilation error: error line 1 at position 33\ninvalid identifier 'PREMIUM.POLICY_AMOUNT' (InvalidArgument; Prepare)","   POLICY__POLICY_NUMBER  TOTAL_POLICY_AMOUNT
0            31003000336                86000
1            31003000337                12000",false,true,,
HQLS: Policy,How many policies do we have?,"How many
policies do we have?",1700625211.3839223,0,"SELECT COUNT(*) AS NoOfPolicy
FROM policy",SELECT COUNT(*) FROM Policy,"select * from {{
    semantic_layer.query(metrics=['number_of_policies'])
}}","   NOOFPOLICY
0           2","   COUNT(*)
0         2","   NUMBER_OF_POLICIES
0                   2",true,true,,
HQLS: Claim,How many claims do we have?,"How many
claims do we have?",1700625229.9903297,1,"SELECT COUNT(*) AS NoOfClaims
FROM claim",SELECT COUNT(*) FROM Claim,"select * from {{
    semantic_layer.query(metrics=['claims'])
}}","   NOOFCLAIMS
0           2","   COUNT(*)
0         2","   CLAIMS
0       2",true,true,,
HQLS: Claim - Loss Payment&Loss Reserve,"What is the total loss amounts, which is the sum of loss payment, loss reserve amount by claim number?","What is the total loss amounts, which is the sum
of loss payment, loss reserve amount by claim number?",1700625248.3102643,1,"SELECT
    company_claim_number,
    (ca_lp.claim_amount + ca_lr.claim_amount ) as LossAmount
FROM
    Claim
    inner join claim_amount ca_lp on claim.claim_identifier = ca_lp.claim_identifier
    inner JOIN loss_payment ON ca_lp.claim_amount_identifier = loss_payment.claim_amount_identifier
    inner join claim_amount ca_lr on claim.claim_identifier = ca_lr.claim_identifier
    inner JOIN loss_reserve ON ca_lr.claim_amount_identifier = loss_reserve.claim_amount_identifier
","SELECT Claim.Claim_Identifier, 
       SUM(Loss_Payment.Claim_Amount) AS Total_Loss_Payment, 
       SUM(Loss_Reserve.Claim_Amount) AS Total_Loss_Reserve
FROM Claim
LEFT JOIN Claim_Amount AS Loss_Payment ON Claim.Claim_Identifier = Loss_Payment.Claim_Identifier
LEFT JOIN Claim_Amount AS Loss_Reserve ON Claim.Claim_Identifier = Loss_Reserve.Claim_Identifier
WHERE Loss_Payment.Claim_Amount_Identifier IN (SELECT Claim_Amount_Identifier FROM Loss_Payment)
AND Loss_Reserve.Claim_Amount_Identifier IN (SELECT Claim_Amount_Identifier FROM Loss_Reserve)
GROUP BY Claim.Claim_Identifier;","select * from {{
    semantic_layer.query(metrics=['loss_payment_amount', 'loss_reserve_amount', 'total_loss_amount'], 
    group_by=['claim_identifier__company_claim_number'])
    }}","   COMPANY_CLAIM_NUMBER  LOSSAMOUNT
0              12312701        2200
1              12312702        4400","   CLAIM_IDENTIFIER  TOTAL_LOSS_PAYMENT  TOTAL_LOSS_RESERVE
0                 1                1200                1000
1                 2                2300                2100","   CLAIM_IDENTIFIER__COMPANY_CLAIM_NUMBER  LOSS_PAYMENT_AMOUNT  LOSS_RESERVE_AMOUNT  TOTAL_LOSS_AMOUNT
0                                12312701                 1200                 1000               2200
1                                12312702                 2300                 2100               4400",false,true,"""None of [Index(['COMPANY_CLAIM_NUMBER', 'LOSSAMOUNT'], dtype='object')] are in the [columns]""",
HQLS: What is the average time to settle a claim by policy number?,What is the average time to settle a claim by policy number?,"What is the average time to
settle a claim by policy number?",1700625282.8969197,1,"select policy_number, avg(DATE_DIFF(claim_open_date, claim_close_date, ""day""))
from claim 
inner join claim_coverage on claim.claim_identifier = claim_coverage.claim_identifier
inner join policy_coverage_detail on claim_coverage.policy_coverage_detail_identifier = policy_coverage_detail.policy_coverage_detail_identifier
inner join policy on policy.policy_identifier = policy_coverage_detail.policy_identifier
where claim_close_date IS NOT NULL
group by policy_number
","SELECT Policy.Policy_Number, AVG(DATEDIFF(day, Claim.Claim_Open_Date, Claim.Claim_Close_Date)) as Average_Settlement_Days
FROM Claim 
JOIN Policy_Coverage_Detail ON Claim.Claim_Identifier = Policy_Coverage_Detail.Policy_Coverage_Detail_Identifier
JOIN Policy ON Policy_Coverage_Detail.Policy_Identifier = Policy.Policy_Identifier
WHERE Claim.Claim_Close_Date IS NOT NULL
GROUP BY Policy.Policy_Number","select * from {{
    semantic_layer.query(metrics=['avg_time_to_settle_claim'], 
    group_by=['policy__policy_number'])
}}","   POLICY_NUMBER  AVG(DATEDIFF(DAY, CLAIM_OPEN_DATE, CLAIM_CLOSE_DATE))
0    31003000336                                               20.5    ","   POLICY_NUMBER AVERAGE_SETTLEMENT_DAYS
0    31003000336               20.500000","                                                                                                                                                                                                                                                                                                                                                                                                                 error
0  INVALID_ARGUMENT: [FlightSQL] Unable To Satisfy Query Error: Dimensions ['policy__policy_number'] cannot be resolved for metrics ['avg_time_to_settle_claim']. The invalid dimension may not exist, require an ambiguous join (e.g. a join path that can be satisfied in multiple ways), or require a fanout join.\n\nSuggestions for invalid dimension 'policy__policy_number':\n    [] (InvalidArgument; Prepare)",true,false,,
HQLS: Policy - Coverage - Premium,What is the average policy size which is the the total amount of premium divided by the number of policies?,"What is the average policy size which is the the
total amount of premium divided by the number of policies?",1700625307.2253232,1,"SELECT
    SUM(policy_amount)/COUNT(DISTINCT policy_number) AS avgPolicySize
FROM
   policy_coverage_detail 
    inner join policy on policy.policy_identifier = policy_coverage_detail.policy_identifier
    inner join policy_amount on policy_coverage_detail.policy_coverage_detail_identifier = policy_amount.policy_coverage_detail_identifier
    inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
","SELECT AVG(Total_Premium/Policy_Count) AS Average_Policy_Size
FROM
(
    SELECT SUM(Policy_Amount) AS Total_Premium, COUNT(DISTINCT Policy_Identifier) AS Policy_Count
    FROM Policy_Amount
    INNER JOIN Premium
    ON Policy_Amount.Policy_Amount_Identifier = Premium.Policy_Amount_Identifier
) AS Subquery","select avg(total_policy_amount / number_of_policies) as avg_policy_size from {{
    semantic_layer.query(metrics=['total_policy_amount', 'number_of_policies'])
}}","  AVGPOLICYSIZE
0  49000.000000","  AVERAGE_POLICY_SIZE
0  49000.000000000000","        AVG_POLICY_SIZE
0  2849000.000000000000",true,false,,"""None of [Index(['AVGPOLICYSIZE'], dtype='object')] are in the [columns]"""
HQLS: Policy - Agent,How many policies have agents sold by agent id?,"How many policies have
agents sold by agent id?",1700625333.7262793,1,"select  party_identifier as agentid, count(policy.policy_number) as NoOfPolicies
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
where agreement_party_role.party_role_code = 'AG'
group by party_identifier","SELECT Party_Identifier AS Agent_ID, COUNT(DISTINCT Policy_Identifier) AS Number_of_Policies_Sold
FROM Agreement_Party_Role
WHERE Party_Role_Code = 'Agent'
GROUP BY Party_Identifier;","select * from {{
    semantic_layer.query(metrics=['number_of_policies'], 
    group_by=['policy__party_identifier_dim'],
    where=""{{ Dimension('policy__party_role_code') }} = 'AG'""
    )}}","   AGENTID  NOOFPOLICIES
0        2             2","                                                                                                                                                 error
0  INVALID_ARGUMENT: [FlightSQL] SQL compilation error: error line 1 at position 52\ninvalid identifier 'POLICY_IDENTIFIER' (InvalidArgument; Prepare)","   POLICY__PARTY_IDENTIFIER_DIM  NUMBER_OF_POLICIES
0                             2                   2",false,true,,
HQLS: What is the total amount of premiums that a policy holder has paid?,What is the total amount of premiums that a policy holder has paid?,"What is the total amount of
premiums that a policy holder has paid?",1700625356.130253,1,"select party_identifier, sum(policy_amount)
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
inner join policy_amount on policy.policy_identifier = policy_amount.policy_identifier
inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
where agreement_party_role.party_role_code = 'PH'
group by party_identifier","SELECT SUM(Policy_Amount) AS Total_Premiums_Paid
FROM Premium
INNER JOIN Policy_Amount ON Premium.Policy_Amount_Identifier = Policy_Amount.Policy_Amount_Identifier
INNER JOIN Agreement_Party_Role ON Policy_Amount.Policy_Identifier = Agreement_Party_Role.Agreement_Identifier
WHERE Party_Role_Code = 'Policy Holder';","select * from {{
    semantic_layer.query(metrics=['total_policy_amount'], 
    where=""{{ Dimension('policy_amount__has_premium') }} = 1 AND {{ Dimension('policy__party_role_code') }} = 'PH'"")
}}","   PARTY_IDENTIFIER  SUM(POLICY_AMOUNT)
0                 1               98000","   TOTAL_PREMIUMS_PAID
0                  NaN","   TOTAL_POLICY_AMOUNT
0                98000",false,false,"""None of [Index(['PARTY_IDENTIFIER', 'SUM(POLICY_AMOUNT)'], dtype='object')] are in the [columns]""","""['PARTY_IDENTIFIER'] not in index"""
HQLS: What is the total amount of premiums that a policy holder has paid by policy number?,What is the total amount of premiums that a policy holder has paid by policy number?,"What is the total amount of premiums that
a policy holder has paid by policy number?",1700625383.0980387,1,"select party_identifier, policy_number, sum(policy_amount)
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
inner join policy_amount on policy.policy_identifier = policy_amount.policy_identifier
inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
where agreement_party_role.party_role_code = 'PH'
group by party_identifier, policy_number","SELECT p.Policy_Number, SUM(pa.Policy_Amount) as Total_Premiums_Paid
FROM Policy p
JOIN Policy_Amount pa ON p.Policy_Identifier = pa.Policy_Identifier
JOIN Premium pr ON pa.Policy_Amount_Identifier = pr.Policy_Amount_Identifier
GROUP BY p.Policy_Number;","select * from {{
    semantic_layer.query(metrics=['total_policy_amount'], 
    group_by=['policy__policy_number', 'policy__party_identifier_dim'],
    where=""{{ Dimension('policy_amount__has_premium') }} = 1 AND {{ Dimension('policy__party_role_code') }} = 'PH'""
    )}}","   PARTY_IDENTIFIER  POLICY_NUMBER  SUM(POLICY_AMOUNT)
0                 1    31003000336               86000
1                 1    31003000337               12000","   POLICY_NUMBER  TOTAL_PREMIUMS_PAID
0    31003000336                86000
1    31003000337                12000","   POLICY__PARTY_IDENTIFIER_DIM  POLICY__POLICY_NUMBER  TOTAL_POLICY_AMOUNT
0                             1            31003000336                86000
1                             1            31003000337                12000",false,true,"""['PARTY_IDENTIFIER'] not in index""",
HQLS: Policy - Policy Holder,How many policies does each policy holder have by policy holder id?,"How many policies does each
policy holder have by policy holder id?",1700625411.7123394,1,"select party_identifier, count( policy.policy_number)  as NoOfPolicies
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
where agreement_party_role.party_role_code = 'PH'
group by party_identifier","SELECT Agreement_Party_Role.Party_Identifier AS Policy_Holder_ID, COUNT(DISTINCT Policy.Policy_Identifier) AS Number_of_Policies
FROM Agreement_Party_Role
JOIN Policy ON Agreement_Party_Role.Agreement_Identifier = Policy.Policy_Identifier
GROUP BY Agreement_Party_Role.Party_Identifier;","select * from {{
    semantic_layer.query(metrics=['number_of_policies'], 
    group_by=['policy__party_identifier_dim'],
    where=""{{ Dimension('policy__party_role_code') }} = 'PH'""
    )}}","   PARTY_IDENTIFIER  NOOFPOLICIES
0                 1             2","   POLICY_HOLDER_ID  NUMBER_OF_POLICIES
0                 1                   2
1                 2                   2","   POLICY__PARTY_IDENTIFIER_DIM  NUMBER_OF_POLICIES
0                             1                   2",false,true,"""None of [Index(['NOOFPOLICIES', 'PARTY_IDENTIFIER'], dtype='object')] are in the [columns]""",
HQLS: Policy - Coverage - Claim,How many claims have been placed by policy number?,"How many claims have
been placed by policy number?",1700625435.5893853,1,"select policy_number, count(company_claim_number) as NoOfClaims
from 
    policy 
    inner join policy_coverage_detail on policy.policy_identifier = policy_coverage_detail.policy_identifier
    inner join claim_coverage on claim_coverage.policy_coverage_detail_identifier = policy_coverage_detail.policy_coverage_detail_identifier
    inner join claim on claim.claim_identifier = claim_coverage.claim_identifier
group by policy_number","SELECT Policy_Number, COUNT(*) as Number_of_Claims
FROM Claim
JOIN Policy ON Claim.Claim_Identifier = Policy.Policy_Identifier
GROUP BY Policy_Number;","select * from {{
    semantic_layer.query(metrics=['claims'], 
    group_by=['claim_identifier__policy_number'])
    }}","   POLICY_NUMBER  NOOFCLAIMS
0    31003000336           2","   POLICY_NUMBER  NUMBER_OF_CLAIMS
0    31003000336                 1
1    31003000337                 1","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          error
0  INVALID_ARGUMENT: [FlightSQL] Unable To Satisfy Query Error: Dimensions ['claim_identifier__policy_number'] cannot be resolved for metrics ['claims']. The invalid dimension may not exist, require an ambiguous join (e.g. a join path that can be satisfied in multiple ways), or require a fanout join.\n\nSuggestions for invalid dimension 'claim_identifier__policy_number':\n    ['claim_identifier__company_claim_number',\n     'claim_identifier__company_subclaim_number',\n     'claim_identifier__policy_coverage_detail',\n     'claim_identifier__claim_identifier',\n     'claim_identifier__claim_description',\n     'claim_identifier__claim_open_date__year'] (InvalidArgument; Prepare)",false,false,"""['NOOFCLAIMS'] not in index""",
HQLS: What is the total amount of premiums paid by policy number?,What is the total amount of premiums paid by policy number?,"What is the total amount of
premiums paid by policy number?",1700625455.6927092,1,"select policy_number, sum(policy_amount) as TotalPremiumAmount
from 
    policy 
    inner join policy_amount on policy.policy_identifier = policy_amount.policy_identifier
    inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
group by policy_number","SELECT Policy_Number, SUM(Policy_Amount) as Total_Premiums
FROM Policy
JOIN Policy_Amount ON Policy.Policy_Identifier = Policy_Amount.Policy_Identifier
JOIN Premium ON Policy_Amount.Policy_Amount_Identifier = Premium.Policy_Amount_Identifier
GROUP BY Policy_Number;","select * from {{
    semantic_layer.query(metrics=['total_policy_amount'], 
    group_by=['policy__policy_number'],
    where=""{{ Dimension('policy_amount__has_premium') }} = 1""
    )}}","   POLICY_NUMBER  TOTALPREMIUMAMOUNT
0    31003000336               86000
1    31003000337               12000","   POLICY_NUMBER  TOTAL_PREMIUMS
0    31003000336           86000
1    31003000337           12000","   POLICY__POLICY_NUMBER  TOTAL_POLICY_AMOUNT
0            31003000336                86000
1            31003000337                12000",true,true,,
HQLS: Policy,How many policies do we have?,"How many
policies do we have?",1700625479.7884114,1,"SELECT COUNT(*) AS NoOfPolicy
FROM policy",SELECT COUNT(*) FROM Policy,"select * from {{
    semantic_layer.query(metrics=['number_of_policies'])
}}","   NOOFPOLICY
0           2","   COUNT(*)
0         2","   NUMBER_OF_POLICIES
0                   2",true,true,,
HQLS: Claim,How many claims do we have?,"How many
claims do we have?",1700625498.2290187,2,"SELECT COUNT(*) AS NoOfClaims
FROM claim",SELECT COUNT(*) FROM Claim;,"select * from {{
    semantic_layer.query(metrics=['claims'])
}}","   NOOFCLAIMS
0           2","   COUNT(*)
0         2","   CLAIMS
0       2",true,true,,
HQLS: Claim - Loss Payment&Loss Reserve,"What is the total loss amounts, which is the sum of loss payment, loss reserve amount by claim number?","What is the total loss amounts, which is the sum
of loss payment, loss reserve amount by claim number?",1700625518.6029954,2,"SELECT
    company_claim_number,
    (ca_lp.claim_amount + ca_lr.claim_amount ) as LossAmount
FROM
    Claim
    inner join claim_amount ca_lp on claim.claim_identifier = ca_lp.claim_identifier
    inner JOIN loss_payment ON ca_lp.claim_amount_identifier = loss_payment.claim_amount_identifier
    inner join claim_amount ca_lr on claim.claim_identifier = ca_lr.claim_identifier
    inner JOIN loss_reserve ON ca_lr.claim_amount_identifier = loss_reserve.claim_amount_identifier
","SELECT 
    Claim.Claim_Identifier, 
    SUM(Loss_Payment.Claim_Amount) AS Total_Loss_Payment,
    SUM(Loss_Reserve.Claim_Amount) AS Total_Loss_Reserve
FROM 
    Claim 
LEFT JOIN 
    Claim_Amount ON Claim.Claim_Identifier = Claim_Amount.Claim_Identifier 
LEFT JOIN 
    Loss_Payment ON Claim_Amount.Claim_Amount_Identifier = Loss_Payment.Claim_Amount_Identifier 
LEFT JOIN 
    Loss_Reserve ON Claim_Amount.Claim_Amount_Identifier = Loss_Reserve.Claim_Amount_Identifier 
GROUP BY 
    Claim.Claim_Identifier;","select * from {{
    semantic_layer.query(metrics=['loss_payment_amount', 'loss_reserve_amount'], 
    group_by=['claim_identifier__company_claim_number'])
    }}","   COMPANY_CLAIM_NUMBER  LOSSAMOUNT
0              12312701        2200
1              12312702        4400","                                                                                                                                                        error
0  INVALID_ARGUMENT: [FlightSQL] SQL compilation error: error line 3 at position 8\ninvalid identifier 'LOSS_PAYMENT.CLAIM_AMOUNT' (InvalidArgument; Prepare)","   CLAIM_IDENTIFIER__COMPANY_CLAIM_NUMBER  LOSS_PAYMENT_AMOUNT  LOSS_RESERVE_AMOUNT
0                                12312701                 1200                 1000
1                                12312702                 2300                 2100",false,false,,"""['LOSSAMOUNT'] not in index"""
HQLS: What is the average time to settle a claim by policy number?,What is the average time to settle a claim by policy number?,"What is the average time to
settle a claim by policy number?",1700625549.3241067,2,"select policy_number, avg(DATE_DIFF(claim_open_date, claim_close_date, ""day""))
from claim 
inner join claim_coverage on claim.claim_identifier = claim_coverage.claim_identifier
inner join policy_coverage_detail on claim_coverage.policy_coverage_detail_identifier = policy_coverage_detail.policy_coverage_detail_identifier
inner join policy on policy.policy_identifier = policy_coverage_detail.policy_identifier
where claim_close_date IS NOT NULL
group by policy_number
","SELECT Policy_Number, AVG(DATEDIFF(day, Claim_Open_Date, Claim_Close_Date)) AS Avg_Settle_Time
FROM Claim 
JOIN Policy ON Claim.Claim_Identifier = Policy.Policy_Identifier
WHERE Claim_Close_Date IS NOT NULL
GROUP BY Policy_Number;","select * from {{
    semantic_layer.query(metrics=['avg_time_to_settle_claim'], 
    group_by=['policy__policy_number'])
    }}","   POLICY_NUMBER  AVG(DATEDIFF(DAY, CLAIM_OPEN_DATE, CLAIM_CLOSE_DATE))
0    31003000336                                               20.5    ","   POLICY_NUMBER AVG_SETTLE_TIME
0    31003000336       16.000000
1    31003000337       25.000000","                                                                                                                                                                                                                                                                                                                                                                                                                 error
0  INVALID_ARGUMENT: [FlightSQL] Unable To Satisfy Query Error: Dimensions ['policy__policy_number'] cannot be resolved for metrics ['avg_time_to_settle_claim']. The invalid dimension may not exist, require an ambiguous join (e.g. a join path that can be satisfied in multiple ways), or require a fanout join.\n\nSuggestions for invalid dimension 'policy__policy_number':\n    [] (InvalidArgument; Prepare)",false,false,,
HQLS: Policy - Coverage - Premium,What is the average policy size which is the the total amount of premium divided by the number of policies?,"What is the average policy size which is the the
total amount of premium divided by the number of policies?",1700625570.3612316,2,"SELECT
    SUM(policy_amount)/COUNT(DISTINCT policy_number) AS avgPolicySize
FROM
   policy_coverage_detail 
    inner join policy on policy.policy_identifier = policy_coverage_detail.policy_identifier
    inner join policy_amount on policy_coverage_detail.policy_coverage_detail_identifier = policy_amount.policy_coverage_detail_identifier
    inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
","SELECT AVG(Premium_Total) AS Average_Policy_Size
FROM
(
    SELECT Policy_Identifier, SUM(Policy_Amount) AS Premium_Total
    FROM Policy_Amount
    INNER JOIN Premium
    ON Policy_Amount.Policy_Amount_Identifier = Premium.Policy_Amount_Identifier
    GROUP BY Policy_Identifier
) AS Policy_Premiums","select * from {{
    semantic_layer.query(metrics=['total_policy_amount', 'number_of_policies'], 
    group_by=[Dimension('policy__policy_effective_date').grain('month')],
    where=""{{ Dimension('policy_amount__has_premium') }} = 1""
    )}}","  AVGPOLICYSIZE
0  49000.000000","  AVERAGE_POLICY_SIZE
0        49000.000000","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 error
0  INVALID_ARGUMENT: [FlightSQL] Unable To Satisfy Query Error: Dimensions ['policy_amount__has_premium'] cannot be resolved for metrics ['number_of_policies', 'total_policy_amount']. The invalid dimension may not exist, require an ambiguous join (e.g. a join path that can be satisfied in multiple ways), or require a fanout join.\n\nSuggestions for invalid dimension 'policy_amount__has_premium':\n    ['policy__claim',\n     'policy__year_built__year',\n     'policy__expiration_date__quarter',\n     'policy__expiration_date__year',\n     'policy__status_code',\n     'policy__expiration_date__day'] (InvalidArgument; Prepare)",true,false,,
HQLS: Policy - Agent,How many policies have agents sold by agent id?,"How many policies have
agents sold by agent id?",1700625595.5177813,2,"select  party_identifier as agentid, count(policy.policy_number) as NoOfPolicies
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
where agreement_party_role.party_role_code = 'AG'
group by party_identifier","SELECT Party_Identifier AS Agent_ID, COUNT(Policy_Identifier) AS Policies_Sold
FROM Agreement_Party_Role 
WHERE Party_Role_Code = 'Agent'
GROUP BY Party_Identifier;","select * from {{
    semantic_layer.query(metrics=['number_of_policies'], 
    group_by=['policy__party_identifier_dim'],
    where=""{{ Dimension('policy__party_role_code') }} = 'AG'""
    )}}","   AGENTID  NOOFPOLICIES
0        2             2","                                                                                                                                                 error
0  INVALID_ARGUMENT: [FlightSQL] SQL compilation error: error line 1 at position 43\ninvalid identifier 'POLICY_IDENTIFIER' (InvalidArgument; Prepare)","   POLICY__PARTY_IDENTIFIER_DIM  NUMBER_OF_POLICIES
0                             2                   2",false,true,,
HQLS: What is the total amount of premiums that a policy holder has paid?,What is the total amount of premiums that a policy holder has paid?,"What is the total amount of
premiums that a policy holder has paid?",1700625621.009776,2,"select party_identifier, sum(policy_amount)
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
inner join policy_amount on policy.policy_identifier = policy_amount.policy_identifier
inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
where agreement_party_role.party_role_code = 'PH'
group by party_identifier","SELECT SUM(Policy_Amount)
FROM Premium
INNER JOIN Policy_Amount ON Premium.Policy_Amount_Identifier = Policy_Amount.Policy_Amount_Identifier
INNER JOIN Agreement_Party_Role ON Policy_Amount.Policy_Identifier = Agreement_Party_Role.Agreement_Identifier
WHERE Party_Role_Code = 'Policy Holder';","select * from {{
    semantic_layer.query(metrics=['total_policy_amount'], 
    group_by=['policy__party_identifier_dim'],
    where=""{{ Dimension('policy_amount__has_premium') }} = 1 AND {{ Dimension('policy__party_role_code') }} = 'PH'""
    )}}","   PARTY_IDENTIFIER  SUM(POLICY_AMOUNT)
0                 1               98000","   SUM(POLICY_AMOUNT)
0                 NaN","   POLICY__PARTY_IDENTIFIER_DIM  TOTAL_POLICY_AMOUNT
0                             1                98000",false,true,"""['PARTY_IDENTIFIER'] not in index""",
HQLS: What is the total amount of premiums that a policy holder has paid by policy number?,What is the total amount of premiums that a policy holder has paid by policy number?,"What is the total amount of premiums that
a policy holder has paid by policy number?",1700625650.5495152,2,"select party_identifier, policy_number, sum(policy_amount)
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
inner join policy_amount on policy.policy_identifier = policy_amount.policy_identifier
inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
where agreement_party_role.party_role_code = 'PH'
group by party_identifier, policy_number","SELECT Policy.Policy_Number, SUM(Premium.Policy_Amount) AS Total_Premiums_Paid
FROM Policy
JOIN Policy_Amount ON Policy.Policy_Identifier = Policy_Amount.Policy_Identifier
JOIN Premium ON Policy_Amount.Policy_Amount_Identifier = Premium.Policy_Amount_Identifier
GROUP BY Policy.Policy_Number;","select * from {{
    semantic_layer.query(metrics=['total_policy_amount'], 
    group_by=['policy__policy_number', 'policy__party_identifier_dim'],
    where=""{{ Dimension('policy_amount__has_premium') }} = 1 AND {{ Dimension('policy__party_role_code') }} = 'PH'""
    )}}","   PARTY_IDENTIFIER  POLICY_NUMBER  SUM(POLICY_AMOUNT)
0                 1    31003000336               86000
1                 1    31003000337               12000","                                                                                                                                                     error
0  INVALID_ARGUMENT: [FlightSQL] SQL compilation error: error line 1 at position 33\ninvalid identifier 'PREMIUM.POLICY_AMOUNT' (InvalidArgument; Prepare)","   POLICY__PARTY_IDENTIFIER_DIM  POLICY__POLICY_NUMBER  TOTAL_POLICY_AMOUNT
0                             1            31003000336                86000
1                             1            31003000337                12000",false,true,,
HQLS: Policy - Policy Holder,How many policies does each policy holder have by policy holder id?,"How many policies does each
policy holder have by policy holder id?",1700625678.0503316,2,"select party_identifier, count( policy.policy_number)  as NoOfPolicies
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
where agreement_party_role.party_role_code = 'PH'
group by party_identifier","SELECT Party_Identifier as Policy_Holder_Id, COUNT(Policy_Identifier) as Number_of_Policies
FROM Agreement_Party_Role 
INNER JOIN Policy
ON Agreement_Party_Role.Agreement_Identifier = Policy.Policy_Identifier
GROUP BY Party_Identifier;","select * from {{
    semantic_layer.query(metrics=['number_of_policies'], 
    group_by=['policy__party_identifier_dim'],
    where=""{{ Dimension('policy__party_role_code') }} = 'PH'"")
}}","   PARTY_IDENTIFIER  NOOFPOLICIES
0                 1             2","   POLICY_HOLDER_ID  NUMBER_OF_POLICIES
0                 1                   2
1                 2                   2","   POLICY__PARTY_IDENTIFIER_DIM  NUMBER_OF_POLICIES
0                             1                   2",false,true,"""None of [Index(['NOOFPOLICIES', 'PARTY_IDENTIFIER'], dtype='object')] are in the [columns]""",
HQLS: Policy - Coverage - Claim,How many claims have been placed by policy number?,"How many claims have
been placed by policy number?",1700625701.849245,2,"select policy_number, count(company_claim_number) as NoOfClaims
from 
    policy 
    inner join policy_coverage_detail on policy.policy_identifier = policy_coverage_detail.policy_identifier
    inner join claim_coverage on claim_coverage.policy_coverage_detail_identifier = policy_coverage_detail.policy_coverage_detail_identifier
    inner join claim on claim.claim_identifier = claim_coverage.claim_identifier
group by policy_number","SELECT Policy_Number, COUNT(*) as Number_of_Claims
FROM Claim 
JOIN Policy ON Claim.Claim_Identifier = Policy.Policy_Identifier
GROUP BY Policy_Number;","select * from {{
    semantic_layer.query(metrics=['claims'], 
    group_by=['claim_identifier__policy_number'])
}}","   POLICY_NUMBER  NOOFCLAIMS
0    31003000336           2","   POLICY_NUMBER  NUMBER_OF_CLAIMS
0    31003000336                 1
1    31003000337                 1","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          error
0  INVALID_ARGUMENT: [FlightSQL] Unable To Satisfy Query Error: Dimensions ['claim_identifier__policy_number'] cannot be resolved for metrics ['claims']. The invalid dimension may not exist, require an ambiguous join (e.g. a join path that can be satisfied in multiple ways), or require a fanout join.\n\nSuggestions for invalid dimension 'claim_identifier__policy_number':\n    ['claim_identifier__company_claim_number',\n     'claim_identifier__company_subclaim_number',\n     'claim_identifier__policy_coverage_detail',\n     'claim_identifier__claim_identifier',\n     'claim_identifier__claim_description',\n     'claim_identifier__claim_open_date__year'] (InvalidArgument; Prepare)",false,false,"""['NOOFCLAIMS'] not in index""",
HQLS: What is the total amount of premiums paid by policy number?,What is the total amount of premiums paid by policy number?,"What is the total amount of
premiums paid by policy number?",1700625722.6580977,2,"select policy_number, sum(policy_amount) as TotalPremiumAmount
from 
    policy 
    inner join policy_amount on policy.policy_identifier = policy_amount.policy_identifier
    inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
group by policy_number","SELECT Policy.Policy_Number, SUM(Premium.Policy_Amount) AS Total_Premiums
FROM Policy
JOIN Policy_Amount ON Policy.Policy_Identifier = Policy_Amount.Policy_Identifier
JOIN Premium ON Policy_Amount.Policy_Amount_Identifier = Premium.Policy_Amount_Identifier
GROUP BY Policy.Policy_Number;","select * from {{
    semantic_layer.query(metrics=['total_policy_amount'], 
    group_by=['policy__policy_number'],
    where=""{{ Dimension('policy_amount__has_premium') }} = 1""
    )}}","   POLICY_NUMBER  TOTALPREMIUMAMOUNT
0    31003000336               86000
1    31003000337               12000","                                                                                                                                                     error
0  INVALID_ARGUMENT: [FlightSQL] SQL compilation error: error line 1 at position 33\ninvalid identifier 'PREMIUM.POLICY_AMOUNT' (InvalidArgument; Prepare)","   POLICY__POLICY_NUMBER  TOTAL_POLICY_AMOUNT
0            31003000336                86000
1            31003000337                12000",false,true,,
HQLS: Policy,How many policies do we have?,"How many
policies do we have?",1700625747.2584639,2,"SELECT COUNT(*) AS NoOfPolicy
FROM policy",SELECT COUNT(*) FROM Policy,"select * from {{
    semantic_layer.query(metrics=['number_of_policies'])
}}","   NOOFPOLICY
0           2","   COUNT(*)
0         2","   NUMBER_OF_POLICIES
0                   2",true,true,,
HQLS: Claim,How many claims do we have?,"How many
claims do we have?",1700625764.4373405,3,"SELECT COUNT(*) AS NoOfClaims
FROM claim",SELECT COUNT(*) FROM Claim;,"select * from {{
    semantic_layer.query(metrics=['claims'])
}}","   NOOFCLAIMS
0           2","   COUNT(*)
0         2","   CLAIMS
0       2",true,true,,
HQLS: Claim - Loss Payment&Loss Reserve,"What is the total loss amounts, which is the sum of loss payment, loss reserve amount by claim number?","What is the total loss amounts, which is the sum
of loss payment, loss reserve amount by claim number?",1700625781.7392519,3,"SELECT
    company_claim_number,
    (ca_lp.claim_amount + ca_lr.claim_amount ) as LossAmount
FROM
    Claim
    inner join claim_amount ca_lp on claim.claim_identifier = ca_lp.claim_identifier
    inner JOIN loss_payment ON ca_lp.claim_amount_identifier = loss_payment.claim_amount_identifier
    inner join claim_amount ca_lr on claim.claim_identifier = ca_lr.claim_identifier
    inner JOIN loss_reserve ON ca_lr.claim_amount_identifier = loss_reserve.claim_amount_identifier
","SELECT Claim.Claim_Identifier, 
       SUM(Loss_Payment.Claim_Amount) AS Loss_Payment_Amount, 
       SUM(Loss_Reserve.Claim_Amount) AS Loss_Reserve_Amount, 
       (SUM(Loss_Payment.Claim_Amount) + SUM(Loss_Reserve.Claim_Amount)) AS Total_Loss_Amount
FROM Claim
LEFT JOIN Claim_Amount AS Loss_Payment ON Claim.Claim_Identifier = Loss_Payment.Claim_Identifier AND Loss_Payment.Claim_Amount_Identifier IN (SELECT Claim_Amount_Identifier FROM Loss_Payment)
LEFT JOIN Claim_Amount AS Loss_Reserve ON Claim.Claim_Identifier = Loss_Reserve.Claim_Identifier AND Loss_Reserve.Claim_Amount_Identifier IN (SELECT Claim_Amount_Identifier FROM Loss_Reserve)
GROUP BY Claim.Claim_Identifier;","select * from {{
    semantic_layer.query(metrics=['loss_payment_amount', 'loss_reserve_amount', 'total_loss_amount'], 
    group_by=['claim_identifier__company_claim_number'])
}}","   COMPANY_CLAIM_NUMBER  LOSSAMOUNT
0              12312701        2200
1              12312702        4400","   CLAIM_IDENTIFIER  LOSS_PAYMENT_AMOUNT  LOSS_RESERVE_AMOUNT  TOTAL_LOSS_AMOUNT
0                 1                 1200                 1000               2200
1                 2                 2300                 2100               4400","   CLAIM_IDENTIFIER__COMPANY_CLAIM_NUMBER  LOSS_PAYMENT_AMOUNT  LOSS_RESERVE_AMOUNT  TOTAL_LOSS_AMOUNT
0                                12312701                 1200                 1000               2200
1                                12312702                 2300                 2100               4400",false,true,"""['COMPANY_CLAIM_NUMBER'] not in index""",
HQLS: What is the average time to settle a claim by policy number?,What is the average time to settle a claim by policy number?,"What is the average time to
settle a claim by policy number?",1700625814.5074081,3,"select policy_number, avg(DATE_DIFF(claim_open_date, claim_close_date, ""day""))
from claim 
inner join claim_coverage on claim.claim_identifier = claim_coverage.claim_identifier
inner join policy_coverage_detail on claim_coverage.policy_coverage_detail_identifier = policy_coverage_detail.policy_coverage_detail_identifier
inner join policy on policy.policy_identifier = policy_coverage_detail.policy_identifier
where claim_close_date IS NOT NULL
group by policy_number
","SELECT Policy_Number, AVG(DATEDIFF(day, Claim_Open_Date, Claim_Close_Date)) AS Average_Settlement_Time
FROM Claim 
JOIN Policy ON Claim.Claim_Identifier = Policy.Policy_Identifier
WHERE Claim_Close_Date IS NOT NULL
GROUP BY Policy_Number;","select * from {{
    semantic_layer.query(metrics=['avg_time_to_settle_claim'], 
    group_by=['policy__policy_number'])
    }}","   POLICY_NUMBER  AVG(DATEDIFF(DAY, CLAIM_OPEN_DATE, CLAIM_CLOSE_DATE))
0    31003000336                                               20.5    ","   POLICY_NUMBER AVERAGE_SETTLEMENT_TIME
0    31003000336               16.000000
1    31003000337               25.000000","                                                                                                                                                                                                                                                                                                                                                                                                                 error
0  INVALID_ARGUMENT: [FlightSQL] Unable To Satisfy Query Error: Dimensions ['policy__policy_number'] cannot be resolved for metrics ['avg_time_to_settle_claim']. The invalid dimension may not exist, require an ambiguous join (e.g. a join path that can be satisfied in multiple ways), or require a fanout join.\n\nSuggestions for invalid dimension 'policy__policy_number':\n    [] (InvalidArgument; Prepare)",false,false,,
HQLS: Policy - Coverage - Premium,What is the average policy size which is the the total amount of premium divided by the number of policies?,"What is the average policy size which is the the
total amount of premium divided by the number of policies?",1700625836.792746,3,"SELECT
    SUM(policy_amount)/COUNT(DISTINCT policy_number) AS avgPolicySize
FROM
   policy_coverage_detail 
    inner join policy on policy.policy_identifier = policy_coverage_detail.policy_identifier
    inner join policy_amount on policy_coverage_detail.policy_coverage_detail_identifier = policy_amount.policy_coverage_detail_identifier
    inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
","SELECT AVG(Premium_Size) AS Average_Policy_Size
FROM
(
    SELECT SUM(Policy_Amount) AS Premium_Size
    FROM Premium
    INNER JOIN Policy_Amount ON Premium.Policy_Amount_Identifier = Policy_Amount.Policy_Amount_Identifier
    GROUP BY Policy_Amount.Policy_Identifier
) AS Policy_Premiums","select avg(total_policy_amount / number_of_policies) as average_policy_size from {{
    semantic_layer.query(metrics=['total_policy_amount', 'number_of_policies'])
}}","  AVGPOLICYSIZE
0  49000.000000","  AVERAGE_POLICY_SIZE
0        49000.000000","    AVERAGE_POLICY_SIZE
0  2849000.000000000000",true,false,,"""None of [Index(['AVGPOLICYSIZE'], dtype='object')] are in the [columns]"""
HQLS: Policy - Agent,How many policies have agents sold by agent id?,"How many policies have
agents sold by agent id?",1700625862.6404016,3,"select  party_identifier as agentid, count(policy.policy_number) as NoOfPolicies
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
where agreement_party_role.party_role_code = 'AG'
group by party_identifier","SELECT Agreement_Party_Role.Party_Identifier AS Agent_ID, COUNT(DISTINCT Policy.Policy_Identifier) AS Policies_Sold
FROM Agreement_Party_Role
JOIN Policy ON Agreement_Party_Role.Agreement_Identifier = Policy.Policy_Identifier
WHERE Agreement_Party_Role.Party_Role_Code = 'Agent'
GROUP BY Agreement_Party_Role.Party_Identifier;","select * from {{
    semantic_layer.query(metrics=['number_of_policies'], 
    group_by=['policy__party_identifier_dim'],
    where=""{{ Dimension('policy__party_role_code') }} = 'AG'""
    )}}","   AGENTID  NOOFPOLICIES
0        2             2","Empty DataFrame
Columns: [AGENT_ID, POLICIES_SOLD]
Index: []","   POLICY__PARTY_IDENTIFIER_DIM  NUMBER_OF_POLICIES
0                             2                   2",false,true,"""None of [Index(['AGENTID', 'NOOFPOLICIES'], dtype='object')] are in the [columns]""",
HQLS: What is the total amount of premiums that a policy holder has paid?,What is the total amount of premiums that a policy holder has paid?,"What is the total amount of
premiums that a policy holder has paid?",1700625888.6100874,3,"select party_identifier, sum(policy_amount)
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
inner join policy_amount on policy.policy_identifier = policy_amount.policy_identifier
inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
where agreement_party_role.party_role_code = 'PH'
group by party_identifier","SELECT SUM(Policy_Amount) AS Total_Premiums_Paid
FROM Premium
JOIN Policy_Amount ON Premium.Policy_Amount_Identifier = Policy_Amount.Policy_Amount_Identifier
JOIN Agreement_Party_Role ON Policy_Amount.Policy_Identifier = Agreement_Party_Role.Agreement_Identifier
WHERE Party_Role_Code = 'PolicyHolder';","select * from {{
    semantic_layer.query(metrics=['total_policy_amount'], 
    where=""{{ Dimension('policy_amount__has_premium') }} = 1 AND {{ Dimension('policy__party_role_code') }} = 'PH'"")
    }}","   PARTY_IDENTIFIER  SUM(POLICY_AMOUNT)
0                 1               98000","   TOTAL_PREMIUMS_PAID
0                  NaN","   TOTAL_POLICY_AMOUNT
0                98000",false,false,"""None of [Index(['PARTY_IDENTIFIER', 'SUM(POLICY_AMOUNT)'], dtype='object')] are in the [columns]""","""['PARTY_IDENTIFIER'] not in index"""
HQLS: What is the total amount of premiums that a policy holder has paid by policy number?,What is the total amount of premiums that a policy holder has paid by policy number?,"What is the total amount of premiums that
a policy holder has paid by policy number?",1700625914.188905,3,"select party_identifier, policy_number, sum(policy_amount)
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
inner join policy_amount on policy.policy_identifier = policy_amount.policy_identifier
inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
where agreement_party_role.party_role_code = 'PH'
group by party_identifier, policy_number","SELECT Policy.Policy_Number, SUM(Premium.Policy_Amount) AS Total_Premiums_Paid
FROM Policy
JOIN Policy_Amount ON Policy.Policy_Identifier = Policy_Amount.Policy_Identifier
JOIN Premium ON Policy_Amount.Policy_Amount_Identifier = Premium.Policy_Amount_Identifier
GROUP BY Policy.Policy_Number;","select * from {{
    semantic_layer.query(metrics=['total_policy_amount'], 
    group_by=['policy__policy_number', 'policy__party_identifier_dim'],
    where=""{{ Dimension('policy_amount__has_premium') }} = 1 AND {{ Dimension('policy__party_role_code') }} = 'PH'""
    )}}","   PARTY_IDENTIFIER  POLICY_NUMBER  SUM(POLICY_AMOUNT)
0                 1    31003000336               86000
1                 1    31003000337               12000","                                                                                                                                                     error
0  INVALID_ARGUMENT: [FlightSQL] SQL compilation error: error line 1 at position 33\ninvalid identifier 'PREMIUM.POLICY_AMOUNT' (InvalidArgument; Prepare)","   POLICY__PARTY_IDENTIFIER_DIM  POLICY__POLICY_NUMBER  TOTAL_POLICY_AMOUNT
0                             1            31003000336                86000
1                             1            31003000337                12000",false,true,,
HQLS: Policy - Policy Holder,How many policies does each policy holder have by policy holder id?,"How many policies does each
policy holder have by policy holder id?",1700625942.2861085,3,"select party_identifier, count( policy.policy_number)  as NoOfPolicies
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
where agreement_party_role.party_role_code = 'PH'
group by party_identifier","SELECT Party_Identifier AS Policy_Holder_ID, COUNT(Policy_Identifier) AS Number_of_Policies
FROM Agreement_Party_Role 
JOIN Policy ON Agreement_Party_Role.Agreement_Identifier = Policy.Policy_Identifier
WHERE Party_Role_Code = 'PolicyHolder'
GROUP BY Party_Identifier;","select * from {{
    semantic_layer.query(metrics=['number_of_policies'], 
    group_by=['policy__party_identifier_dim'],
    where=""{{ Dimension('policy__party_role_code') }} = 'PH'""
    )}}","   PARTY_IDENTIFIER  NOOFPOLICIES
0                 1             2","Empty DataFrame
Columns: [POLICY_HOLDER_ID, NUMBER_OF_POLICIES]
Index: []","   POLICY__PARTY_IDENTIFIER_DIM  NUMBER_OF_POLICIES
0                             1                   2",false,true,"""None of [Index(['NOOFPOLICIES', 'PARTY_IDENTIFIER'], dtype='object')] are in the [columns]""",
HQLS: Policy - Coverage - Claim,How many claims have been placed by policy number?,"How many claims have
been placed by policy number?",1700625969.2207003,3,"select policy_number, count(company_claim_number) as NoOfClaims
from 
    policy 
    inner join policy_coverage_detail on policy.policy_identifier = policy_coverage_detail.policy_identifier
    inner join claim_coverage on claim_coverage.policy_coverage_detail_identifier = policy_coverage_detail.policy_coverage_detail_identifier
    inner join claim on claim.claim_identifier = claim_coverage.claim_identifier
group by policy_number","SELECT Policy_Number, COUNT(*) AS Number_Of_Claims
FROM Claim 
JOIN Policy ON Claim.Claim_Identifier = Policy.Policy_Identifier
GROUP BY Policy_Number;","select * from {{
    semantic_layer.query(metrics=['claims'], 
    group_by=['claim_identifier__policy_number'])
}}","   POLICY_NUMBER  NOOFCLAIMS
0    31003000336           2","   POLICY_NUMBER  NUMBER_OF_CLAIMS
0    31003000336                 1
1    31003000337                 1","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          error
0  INVALID_ARGUMENT: [FlightSQL] Unable To Satisfy Query Error: Dimensions ['claim_identifier__policy_number'] cannot be resolved for metrics ['claims']. The invalid dimension may not exist, require an ambiguous join (e.g. a join path that can be satisfied in multiple ways), or require a fanout join.\n\nSuggestions for invalid dimension 'claim_identifier__policy_number':\n    ['claim_identifier__company_claim_number',\n     'claim_identifier__company_subclaim_number',\n     'claim_identifier__policy_coverage_detail',\n     'claim_identifier__claim_identifier',\n     'claim_identifier__claim_description',\n     'claim_identifier__claim_open_date__year'] (InvalidArgument; Prepare)",false,false,"""['NOOFCLAIMS'] not in index""",
HQLS: What is the total amount of premiums paid by policy number?,What is the total amount of premiums paid by policy number?,"What is the total amount of
premiums paid by policy number?",1700625990.9135594,3,"select policy_number, sum(policy_amount) as TotalPremiumAmount
from 
    policy 
    inner join policy_amount on policy.policy_identifier = policy_amount.policy_identifier
    inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
group by policy_number","SELECT Policy.Policy_Number, SUM(Premium.Policy_Amount) AS Total_Premiums
FROM Policy
JOIN Policy_Amount ON Policy.Policy_Identifier = Policy_Amount.Policy_Identifier
JOIN Premium ON Policy_Amount.Policy_Amount_Identifier = Premium.Policy_Amount_Identifier
GROUP BY Policy.Policy_Number;","select * from {{
    semantic_layer.query(metrics=['total_policy_amount'], 
    group_by=['policy__policy_number'],
    where=""{{ Dimension('policy_amount__has_premium') }} = 1""
    )}}","   POLICY_NUMBER  TOTALPREMIUMAMOUNT
0    31003000336               86000
1    31003000337               12000","                                                                                                                                                     error
0  INVALID_ARGUMENT: [FlightSQL] SQL compilation error: error line 1 at position 33\ninvalid identifier 'PREMIUM.POLICY_AMOUNT' (InvalidArgument; Prepare)","   POLICY__POLICY_NUMBER  TOTAL_POLICY_AMOUNT
0            31003000336                86000
1            31003000337                12000",false,true,,
HQLS: Policy,How many policies do we have?,"How many
policies do we have?",1700626016.8125186,3,"SELECT COUNT(*) AS NoOfPolicy
FROM policy",SELECT COUNT(*) FROM Policy,"select * from {{
    semantic_layer.query(metrics=['number_of_policies'])
}}","   NOOFPOLICY
0           2","   COUNT(*)
0         2","   NUMBER_OF_POLICIES
0                   2",true,true,,
HQLS: Claim,How many claims do we have?,"How many
claims do we have?",1700626035.8281407,4,"SELECT COUNT(*) AS NoOfClaims
FROM claim",SELECT COUNT(*) FROM Claim;,"select * from {{
    semantic_layer.query(metrics=['claims'])
}}","   NOOFCLAIMS
0           2","   COUNT(*)
0         2","   CLAIMS
0       2",true,true,,
HQLS: Claim - Loss Payment&Loss Reserve,"What is the total loss amounts, which is the sum of loss payment, loss reserve amount by claim number?","What is the total loss amounts, which is the sum
of loss payment, loss reserve amount by claim number?",1700626055.216143,4,"SELECT
    company_claim_number,
    (ca_lp.claim_amount + ca_lr.claim_amount ) as LossAmount
FROM
    Claim
    inner join claim_amount ca_lp on claim.claim_identifier = ca_lp.claim_identifier
    inner JOIN loss_payment ON ca_lp.claim_amount_identifier = loss_payment.claim_amount_identifier
    inner join claim_amount ca_lr on claim.claim_identifier = ca_lr.claim_identifier
    inner JOIN loss_reserve ON ca_lr.claim_amount_identifier = loss_reserve.claim_amount_identifier
","SELECT 
    Claim.Claim_Identifier,
    SUM(Loss_Payment.Claim_Amount) AS Total_Loss_Payment,
    SUM(Loss_Reserve.Claim_Amount) AS Total_Loss_Reserve,
    (SUM(Loss_Payment.Claim_Amount) + SUM(Loss_Reserve.Claim_Amount)) AS Total_Loss_Amount
FROM 
    Claim 
LEFT JOIN 
    Claim_Amount ON Claim.Claim_Identifier = Claim_Amount.Claim_Identifier
LEFT JOIN 
    Loss_Payment ON Claim_Amount.Claim_Amount_Identifier = Loss_Payment.Claim_Amount_Identifier
LEFT JOIN 
    Loss_Reserve ON Claim_Amount.Claim_Amount_Identifier = Loss_Reserve.Claim_Amount_Identifier
GROUP BY 
    Claim.Claim_Identifier;","select * from {{
    semantic_layer.query(metrics=['total_loss_amount'], 
    group_by=['claim_identifier__company_claim_number'])
}}","   COMPANY_CLAIM_NUMBER  LOSSAMOUNT
0              12312701        2200
1              12312702        4400","                                                                                                                                                        error
0  INVALID_ARGUMENT: [FlightSQL] SQL compilation error: error line 3 at position 8\ninvalid identifier 'LOSS_PAYMENT.CLAIM_AMOUNT' (InvalidArgument; Prepare)","   CLAIM_IDENTIFIER__COMPANY_CLAIM_NUMBER  TOTAL_LOSS_AMOUNT
0                                12312701               2200
1                                12312702               4400",false,true,,
HQLS: What is the average time to settle a claim by policy number?,What is the average time to settle a claim by policy number?,"What is the average time to
settle a claim by policy number?",1700626083.6015055,4,"select policy_number, avg(DATE_DIFF(claim_open_date, claim_close_date, ""day""))
from claim 
inner join claim_coverage on claim.claim_identifier = claim_coverage.claim_identifier
inner join policy_coverage_detail on claim_coverage.policy_coverage_detail_identifier = policy_coverage_detail.policy_coverage_detail_identifier
inner join policy on policy.policy_identifier = policy_coverage_detail.policy_identifier
where claim_close_date IS NOT NULL
group by policy_number
","SELECT 
    Policy.Policy_Number, 
    AVG(DATEDIFF(day, Claim.Claim_Open_Date, Claim.Claim_Close_Date)) as Average_Settlement_Days
FROM 
    Claim 
INNER JOIN 
    Claim_Coverage ON Claim.Claim_Identifier = Claim_Coverage.Claim_Identifier
INNER JOIN 
    Policy_Coverage_Detail ON Claim_Coverage.Policy_Coverage_Detail_Identifier = Policy_Coverage_Detail.Policy_Coverage_Detail_Identifier
INNER JOIN 
    Policy ON Policy_Coverage_Detail.Policy_Identifier = Policy.Policy_Identifier
WHERE 
    Claim.Claim_Close_Date IS NOT NULL
GROUP BY 
    Policy.Policy_Number;","select * from {{
    semantic_layer.query(metrics=['avg_time_to_settle_claim'], 
    group_by=['policy__policy_number'])
    }}","   POLICY_NUMBER  AVG(DATEDIFF(DAY, CLAIM_OPEN_DATE, CLAIM_CLOSE_DATE))
0    31003000336                                               20.5    ","   POLICY_NUMBER AVERAGE_SETTLEMENT_DAYS
0    31003000336               20.500000","                                                                                                                                                                                                                                                                                                                                                                                                                 error
0  INVALID_ARGUMENT: [FlightSQL] Unable To Satisfy Query Error: Dimensions ['policy__policy_number'] cannot be resolved for metrics ['avg_time_to_settle_claim']. The invalid dimension may not exist, require an ambiguous join (e.g. a join path that can be satisfied in multiple ways), or require a fanout join.\n\nSuggestions for invalid dimension 'policy__policy_number':\n    [] (InvalidArgument; Prepare)",true,false,,
HQLS: Policy - Coverage - Premium,What is the average policy size which is the the total amount of premium divided by the number of policies?,"What is the average policy size which is the the
total amount of premium divided by the number of policies?",1700626112.667178,4,"SELECT
    SUM(policy_amount)/COUNT(DISTINCT policy_number) AS avgPolicySize
FROM
   policy_coverage_detail 
    inner join policy on policy.policy_identifier = policy_coverage_detail.policy_identifier
    inner join policy_amount on policy_coverage_detail.policy_coverage_detail_identifier = policy_amount.policy_coverage_detail_identifier
    inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
","SELECT AVG(Total_Premium) AS Average_Policy_Size
FROM
(
    SELECT Policy_Identifier, SUM(Policy_Amount) AS Total_Premium
    FROM Policy_Amount
    INNER JOIN Premium
    ON Policy_Amount.Policy_Amount_Identifier = Premium.Policy_Amount_Identifier
    GROUP BY Policy_Identifier
) AS SubQuery","select avg(total_policy_amount / number_of_policies) as avg_policy_size from {{
    semantic_layer.query(metrics=['total_policy_amount', 'number_of_policies'])
}}","  AVGPOLICYSIZE
0  49000.000000","  AVERAGE_POLICY_SIZE
0        49000.000000","        AVG_POLICY_SIZE
0  2849000.000000000000",true,false,,"""None of [Index(['AVGPOLICYSIZE'], dtype='object')] are in the [columns]"""
HQLS: Policy - Agent,How many policies have agents sold by agent id?,"How many policies have
agents sold by agent id?",1700626137.5405004,4,"select  party_identifier as agentid, count(policy.policy_number) as NoOfPolicies
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
where agreement_party_role.party_role_code = 'AG'
group by party_identifier","SELECT Agreement_Party_Role.Party_Identifier AS Agent_ID, COUNT(DISTINCT Policy.Policy_Identifier) AS Policies_Sold
FROM Agreement_Party_Role
JOIN Policy ON Agreement_Party_Role.Agreement_Identifier = Policy.Policy_Identifier
WHERE Agreement_Party_Role.Party_Role_Code = 'Agent'
GROUP BY Agreement_Party_Role.Party_Identifier;","select * from {{
    semantic_layer.query(metrics=['number_of_policies'], 
    group_by=['policy__party_identifier_dim'],
    where=""{{ Dimension('policy__party_role_code') }} = 'AG'""
    )}}","   AGENTID  NOOFPOLICIES
0        2             2","Empty DataFrame
Columns: [AGENT_ID, POLICIES_SOLD]
Index: []","   POLICY__PARTY_IDENTIFIER_DIM  NUMBER_OF_POLICIES
0                             2                   2",false,true,"""None of [Index(['AGENTID', 'NOOFPOLICIES'], dtype='object')] are in the [columns]""",
HQLS: What is the total amount of premiums that a policy holder has paid?,What is the total amount of premiums that a policy holder has paid?,"What is the total amount of
premiums that a policy holder has paid?",1700626164.9905422,4,"select party_identifier, sum(policy_amount)
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
inner join policy_amount on policy.policy_identifier = policy_amount.policy_identifier
inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
where agreement_party_role.party_role_code = 'PH'
group by party_identifier","SELECT SUM(Policy_Amount) AS Total_Premiums_Paid
FROM Policy_Amount
INNER JOIN Agreement_Party_Role ON Policy_Amount.Policy_Identifier = Agreement_Party_Role.Agreement_Identifier
WHERE Party_Role_Code = 'PolicyHolder';","select * from {{
    semantic_layer.query(metrics=['total_policy_amount'], 
    where=""{{ Dimension('policy_amount__has_premium') }} = 1 AND {{ Dimension('policy__party_role_code') }} = 'PH'"")
    }}","   PARTY_IDENTIFIER  SUM(POLICY_AMOUNT)
0                 1               98000","   TOTAL_PREMIUMS_PAID
0                  NaN","   TOTAL_POLICY_AMOUNT
0                98000",false,false,"""None of [Index(['PARTY_IDENTIFIER', 'SUM(POLICY_AMOUNT)'], dtype='object')] are in the [columns]""","""['PARTY_IDENTIFIER'] not in index"""
HQLS: What is the total amount of premiums that a policy holder has paid by policy number?,What is the total amount of premiums that a policy holder has paid by policy number?,"What is the total amount of premiums that
a policy holder has paid by policy number?",1700626188.1604133,4,"select party_identifier, policy_number, sum(policy_amount)
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
inner join policy_amount on policy.policy_identifier = policy_amount.policy_identifier
inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
where agreement_party_role.party_role_code = 'PH'
group by party_identifier, policy_number","SELECT Policy.Policy_Number, SUM(Premium.Policy_Amount) AS Total_Premiums_Paid
FROM Policy
JOIN Policy_Amount ON Policy.Policy_Identifier = Policy_Amount.Policy_Identifier
JOIN Premium ON Policy_Amount.Policy_Amount_Identifier = Premium.Policy_Amount_Identifier
GROUP BY Policy.Policy_Number;","select * from {{
    semantic_layer.query(metrics=['total_policy_amount'], 
    group_by=['policy__policy_number', 'policy__party_identifier_dim'],
    where=""{{ Dimension('policy_amount__has_premium') }} = 1 AND {{ Dimension('policy__party_role_code') }} = 'PH'""
    )}}","   PARTY_IDENTIFIER  POLICY_NUMBER  SUM(POLICY_AMOUNT)
0                 1    31003000336               86000
1                 1    31003000337               12000","                                                                                                                                                     error
0  INVALID_ARGUMENT: [FlightSQL] SQL compilation error: error line 1 at position 33\ninvalid identifier 'PREMIUM.POLICY_AMOUNT' (InvalidArgument; Prepare)","   POLICY__PARTY_IDENTIFIER_DIM  POLICY__POLICY_NUMBER  TOTAL_POLICY_AMOUNT
0                             1            31003000336                86000
1                             1            31003000337                12000",false,true,,
HQLS: Policy - Policy Holder,How many policies does each policy holder have by policy holder id?,"How many policies does each
policy holder have by policy holder id?",1700626215.3465662,4,"select party_identifier, count( policy.policy_number)  as NoOfPolicies
from agreement_party_role
join policy on agreement_party_role.agreement_identifier = policy.policy_identifier
where agreement_party_role.party_role_code = 'PH'
group by party_identifier","SELECT Party_Identifier, COUNT(Policy_Identifier) as NumberOfPolicies
FROM Agreement_Party_Role
JOIN Policy ON Agreement_Party_Role.Agreement_Identifier = Policy.Policy_Identifier
WHERE Party_Role_Code = 'Policy Holder'
GROUP BY Party_Identifier;","select * from {{
    semantic_layer.query(metrics=['number_of_policies'], 
    group_by=['policy__party_identifier_dim'],
    where=""{{ Dimension('policy__party_role_code') }} = 'PH'""
    )}}","   PARTY_IDENTIFIER  NOOFPOLICIES
0                 1             2","Empty DataFrame
Columns: [PARTY_IDENTIFIER, NUMBEROFPOLICIES]
Index: []","   POLICY__PARTY_IDENTIFIER_DIM  NUMBER_OF_POLICIES
0                             1                   2",false,true,"""['NOOFPOLICIES'] not in index""",
HQLS: Policy - Coverage - Claim,How many claims have been placed by policy number?,"How many claims have
been placed by policy number?",1700626241.303094,4,"select policy_number, count(company_claim_number) as NoOfClaims
from 
    policy 
    inner join policy_coverage_detail on policy.policy_identifier = policy_coverage_detail.policy_identifier
    inner join claim_coverage on claim_coverage.policy_coverage_detail_identifier = policy_coverage_detail.policy_coverage_detail_identifier
    inner join claim on claim.claim_identifier = claim_coverage.claim_identifier
group by policy_number","SELECT Policy_Number, COUNT(*) as Number_of_Claims
FROM Claim 
JOIN Policy ON Claim.Claim_Identifier = Policy.Policy_Identifier
GROUP BY Policy_Number;","select * from {{
    semantic_layer.query(metrics=['claims'], 
    group_by=['claim_identifier__policy_number'])
}}","   POLICY_NUMBER  NOOFCLAIMS
0    31003000336           2","   POLICY_NUMBER  NUMBER_OF_CLAIMS
0    31003000336                 1
1    31003000337                 1","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          error
0  INVALID_ARGUMENT: [FlightSQL] Unable To Satisfy Query Error: Dimensions ['claim_identifier__policy_number'] cannot be resolved for metrics ['claims']. The invalid dimension may not exist, require an ambiguous join (e.g. a join path that can be satisfied in multiple ways), or require a fanout join.\n\nSuggestions for invalid dimension 'claim_identifier__policy_number':\n    ['claim_identifier__company_claim_number',\n     'claim_identifier__company_subclaim_number',\n     'claim_identifier__policy_coverage_detail',\n     'claim_identifier__claim_identifier',\n     'claim_identifier__claim_description',\n     'claim_identifier__claim_open_date__year'] (InvalidArgument; Prepare)",false,false,"""['NOOFCLAIMS'] not in index""",
HQLS: What is the total amount of premiums paid by policy number?,What is the total amount of premiums paid by policy number?,"What is the total amount of
premiums paid by policy number?",1700626262.0999177,4,"select policy_number, sum(policy_amount) as TotalPremiumAmount
from 
    policy 
    inner join policy_amount on policy.policy_identifier = policy_amount.policy_identifier
    inner join premium on premium.policy_amount_identifier = policy_amount.policy_amount_identifier
group by policy_number","SELECT Policy.Policy_Number, SUM(Premium.Policy_Amount) as Total_Premiums
FROM Policy
JOIN Policy_Amount ON Policy.Policy_Identifier = Policy_Amount.Policy_Identifier
JOIN Premium ON Policy_Amount.Policy_Amount_Identifier = Premium.Policy_Amount_Identifier
GROUP BY Policy.Policy_Number;","select * from {{
    semantic_layer.query(metrics=['total_policy_amount'], 
    group_by=['policy__policy_number'],
    where=""{{ Dimension('policy_amount__has_premium') }} = 1""
    )}}","   POLICY_NUMBER  TOTALPREMIUMAMOUNT
0    31003000336               86000
1    31003000337               12000","                                                                                                                                                     error
0  INVALID_ARGUMENT: [FlightSQL] SQL compilation error: error line 1 at position 33\ninvalid identifier 'PREMIUM.POLICY_AMOUNT' (InvalidArgument; Prepare)","   POLICY__POLICY_NUMBER  TOTAL_POLICY_AMOUNT
0            31003000336                86000
1            31003000337                12000",false,true,,
HQLS: Policy,How many policies do we have?,"How many
policies do we have?",1700626287.379429,4,"SELECT COUNT(*) AS NoOfPolicy
FROM policy",SELECT COUNT(*) FROM Policy,"select * from {{
    semantic_layer.query(metrics=['number_of_policies'])
}}","   NOOFPOLICY
0           2","   COUNT(*)
0         2","   NUMBER_OF_POLICIES
0                   2",true,true,,